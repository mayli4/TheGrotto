pending rewrite this is all horrible and old
